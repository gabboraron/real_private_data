<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<p>Szakdolgozat</p>
<p></p>
<h1 id="bevezetés"><span id="anchor"></span>Bevezetés</h1>
<h2 id="motiváció"><span id="anchor-1"></span>Motiváció</h2>
<p>Jelen világunkban az információ érték, ezért gyakorlatilag mindenki visszaél velük.</p>
<p>Sajnos nem tudhatom azt, hogy az operációs rendszer, amit használok, mennyi információt gyüjt rólam, és mire használja fel. Ez nincs másképp az e-mail szolgáltatókkal, a különböző felhő alapú tárolókkal.</p>
<p>Nem tudhatom, hogy ha egy felhőben tárolom az adataimat, akkor vajon a Google, a Microsoft, a Facebook, az Apple vagy más cégek, akik ilyeneket szolgáltatnak felhasználja-e őket. Ilyen szempontból mondjuk a megnevezettek még korrektek, mert az általános szerződési feltételeikben megfogalmazzák, hogy az adatainkat felhasználják.</p>
<p>Sajnos arra jelenleg nincs erőforrásom, hogy egy saját Operációs rendszert írjak, vagy hogy leellenőrizzek egy Linuxot, Open/Free BSD-t hogy vajon visszaél-e az adataimmal, így ezeknek el kell hinnem, hogy nem teszik.<br />
De tudok csinálni olyan programot, ami azt biztosítja számomra, hogy az adataimat a kliens oldalon titkosítva küldöm el a felhőbe, akkor a felhőben lévő cég nem tudhatja, hogy mik is voltak azok.</p>
<p>Így jött az öltet, hogy először egy egyszerű szervert csinálok, ahol fájlokat tudok tárolni, amikbe az egyszerűség kedvéért először csak szövegeket, vagy telefonkönyvet tudok tárolni.<br />
Így hiába olvashatja az adott szerverszolgáltató az adataimat, nem fog hozzáférni az információhoz, mert az már a kliens oldalon titkosítva van.</p>
<p>Fontos volt számomra, hogy nyílt forráskódú legyen, hogy biztosítva legyen, hogy tényleg titkosít, és tényleg nem ment semmilyen adatot.</p>
<p></p>
<h2 id="teszt-környezet"><span id="anchor-2"></span>Teszt környezet</h2>
<h3 id="hardware"><span id="anchor-3"></span>Hardware</h3>
<p>RAM: 16GB (ez lehet hogy kevés lesz sok felhasználóra.)</p>
<p>Processor: Intel(R) Core(TM) i7-4600U CPU @ 2.10GHz</p>
<h3 id="szoftver"><span id="anchor-4"></span>Szoftver</h3>
<h4 id="operációs-rendszer"><span id="anchor-5"></span>Operációs rendszer</h4>
<p><strong>Distributor ID:</strong>Ubuntu</p>
<p><strong>Description:</strong>Ubuntu 18.04.4 LTS</p>
<p><strong>Release:</strong>18.04</p>
<p><strong>Codename:</strong>bionic</p>
<h4 id="python"><span id="anchor-6"></span>Python</h4>
<p>Python 3.6.9</p>
<table>
<tbody>
<tr class="odd">
<td>tornado</td>
<td>6.0.3</td>
<td><a href="https://www.tornadoweb.org/en/stable/" class="uri">https://www.tornadoweb.org/en/stable/</a><br />
<a href="https://github.com/tornadoweb/tornado/" class="uri">https://github.com/tornadoweb/tornado/</a><br />
<a href="https://pypi.org/project/tornado/3.2.1/">https://pypi.org/project/tornado/</a></td>
</tr>
<tr class="even">
<td>jsonrpcserver</td>
<td>4.1.2</td>
<td><p><a href="https://github.com/bcb/jsonrpcserver" class="uri">https://github.com/bcb/jsonrpcserver</a></p>
<p><a href="https://pypi.org/project/jsonrpcserver/" class="uri">https://pypi.org/project/jsonrpcserver/</a></p></td>
</tr>
<tr class="odd">
<td>pandas</td>
<td>1.0.3</td>
<td><a href="https://pandas.pydata.org/" class="uri">https://pandas.pydata.org/</a><br />
<a href="https://github.com/pandas-dev/pandas" class="uri">https://github.com/pandas-dev/pandas</a><br />
<a href="https://pypi.org/project/pandas/" class="uri">https://pypi.org/project/pandas/</a></td>
</tr>
<tr class="even">
<td>pyexcel-ods</td>
<td>0.5.6</td>
<td><a href="https://github.com/pyexcel/pyexcel-ods" class="uri">https://github.com/pyexcel/pyexcel-ods</a><br />
<a href="https://pypi.org/project/pyexcel-ods/" class="uri">https://pypi.org/project/pyexcel-ods/</a></td>
</tr>
</tbody>
</table>
<p></p>
<h4 id="böngészők"><span id="anchor-7"></span>Böngészők</h4>
<p>Google Chrome80.0.3987.149<a href="https://www.google.com/chrome/" class="uri">https://www.google.com/chrome/</a><br />
Mozilla Firefox74.0 <a href="https://www.mozilla.org/en-US/firefox/" class="uri">https://www.mozilla.org/en-US/firefox/</a></p>
<h4 id="javascript"><span id="anchor-8"></span>JavaScript</h4>
<p>Ecmascript 6</p>
<table>
<tbody>
<tr class="odd">
<td>aes-js</td>
<td>3.1.2</td>
<td><a href="https://www.npmjs.com/package/aes-js" class="uri">https://www.npmjs.com/package/aes-js</a><br />
<a href="https://cdn.rawgit.com/ricmoo/aes-js" class="uri">https://cdn.rawgit.com/ricmoo/aes-js</a></td>
</tr>
<tr class="even">
<td>bootstrap</td>
<td>4.4.1</td>
<td><a href="https://getbootstrap.com/" class="uri">https://getbootstrap.com/</a></td>
</tr>
<tr class="odd">
<td>jquery</td>
<td>3.4.1.slim</td>
<td><a href="https://jquery.com/" class="uri">https://jquery.com/</a></td>
</tr>
<tr class="even">
<td>js-sha256</td>
<td>0.9.0</td>
<td><a href="https://www.npmjs.com/package/js-sha256" class="uri">https://www.npmjs.com/package/js-sha256</a></td>
</tr>
<tr class="odd">
<td>popper.js</td>
<td>1.16.0</td>
<td><a href="https://popper.js.org/" class="uri">https://popper.js.org/</a></td>
</tr>
<tr class="even">
<td>simple-jsonrpc-js</td>
<td>1.0.0</td>
<td><a href="https://github.com/jershell/simple-jsonrpc-js" class="uri">https://github.com/jershell/simple-jsonrpc-js</a></td>
</tr>
</tbody>
</table>
<p></p>
<h1 id="felhasználói-dokumentáció"><span id="anchor-9"></span>Felhasználói dokumentáció</h1>
<h2 id="letöltés-githubról"><span id="anchor-10"></span>Letöltés githubról</h2>
<ol style="list-style-type: decimal">
<li><p>git-tel</p>
<ol style="list-style-type: decimal">
<li>git installálás (ha nincs telepítve)<br />
<strong>sudo apt install git</strong></li>
<li><p>klónozás</p>
<ol style="list-style-type: decimal">
<li><strong>git clone </strong><a href="https://github.com/somla/real_private_data.git"><strong>https://github.com/somla/real_private_data.git</strong></a><strong><br />
</strong>vagy</li>
<li><strong>git clone </strong><a href="mailto:git@github.com"><strong>git@github.com</strong></a><strong>:somla/real_private_data.git<br />
</strong>vagy</li>
<li>Forokolod a saját repoid közé (fejlesztőknek)</li>
</ol></li>
</ol></li>
<li><p>Letöltés githubról zip formátumban</p>
<ol style="list-style-type: decimal">
<li>Egy böngészőben nyissuk meg ezt a linket:<br />
<a href="https://github.com/somla/real_private_data" class="uri">https://github.com/somla/real_private_data</a></li>
<li>Kattintsunk a <strong>Clone or download </strong>gombra</li>
<li>Kattintsunk a <strong>Download ZIP </strong>gombra</li>
<li>Tömörítsük ki<br />
<strong>unzip real_private_data-master.zip</strong></li>
</ol></li>
</ol>
<h2 id="installálás"><span id="anchor-11"></span>Installálás</h2>
<p>Ehhez egy VirtualBoxot használtam, arra feltelepítettem egy Ubuntut, így egy teljesen új linuxon van tesztelve, amin még nincs semmi.</p>
<h3 id="függőségek"><span id="anchor-12"></span>Függőségek</h3>
<h4 id="iptables-persistent"><span id="anchor-13"></span>Iptables-persistent</h4>
<p>Csak ha portforwardingolni akarunk</p>
<p>sudo apt-get install iptables-persistent</p>
<h4 id="pip3"><span id="anchor-14"></span>pip3</h4>
<p>sudo apt install python3-pip</p>
<h4 id="python-csomagok"><span id="anchor-15"></span>Python csomagok</h4>
<p>sudo pip3 install tornado<br />
sudo pip3 install pandas<br />
sudo pip3 install pyexcel-ods<br />
sudo pip3 install jsonrpcserver</p>
<h3 id="előkészületek"><span id="anchor-16"></span>Előkészületek</h3>
<ol style="list-style-type: decimal">
<li>Menjünk abba a mappába, ahova letöltöttük a programot<br />
<strong>cd ./real_private_data</strong></li>
<li>hozzunk létre egy könyvtárat az adatoknak (nem muszáj itt, de akkor át kell állítani a config-ban lásd a Konfiguráció fejezetet)<br />
<strong>mkdir data</strong></li>
<li>hozzunk létre SSL-kulcsot, vagy ha van saját, akkor másoljuk be a .key mappába, vagy adjuk meg a helyét a config.json-ban (lásd a Konfiguráció fejezetet)<br />
<strong>mkdir .key;<br />
openssl req -x509 -out rpd.crt -keyout rpd.key \<br />
-newkey rsa:2048 -nodes -sha256 \<br />
-subj '/CN=localhost' -extensions EXT -config &lt;( \<br />
printf &quot;[dn]\nCN=localhost\n[req]\ndistinguished_name = dn\n[EXT]\nsubjectAltName=DNS:localhost\nkeyUsage=digitalSignature\nextendedKeyUsage=serverAuth&quot;);<br />
cd ..</strong></li>
<li>Hozzunk létre egy mappát a generált javascript fájloknak<br />
<strong>mkdir src/web/generated/</strong></li>
<li>Másoljuk le a config.sample.json-t a config.json-ra<br />
<strong>cd src/python<br />
cp config.sample.json config.json<br />
cd ../..</strong></li>
<li>Hozz létre legalább egy felhasználót<br />
<strong>./bin/server/rpd_create_user.sh</strong></li>
<li>Ha minden jól sikerült, akkor el kell, hogy tudjuk indítani a szervert<br />
<strong>./bin/server/rpd_server.sh</strong></li>
</ol>
<h3 id="linux-service-létrehozás"><span id="anchor-17"></span>Linux service létrehozás</h3>
<p>A Linux service autómatikusan indul, amikor a linux elindul, és újraindul, ha a folyamat valamiért leáll. Én itt egy alapbeállítást mutatok be, további információért nézz utána a Linux folyamatoknak, és a <strong>systemctl</strong> parancsnak</p>
<ol style="list-style-type: decimal">
<li>Ehhez érdemes egy új felhasználót létrehozni, nálam ez “rpd-server” lesz<br />
<strong>sudo adduser rpd-server</strong></li>
<li>hozzunk létre egy új mappát az adatoknak<br />
<strong>sudo mkdir -p /var/local/rpd/data<br />
sudo chown rpd-server:rpd-server /var/local/rpd/data</strong></li>
<li>Csináljunk egy kulcsot a szerverünknek (lásd feljebb: Elókészületek 3. lépés) aminek az rpd-server a tulajdonosa</li>
<li><p>Csináljunk egy config fájlt a service-nek</p>
<ol style="list-style-type: decimal">
<li>Másoljuk le a sample config-ot<br />
<strong>cd {project_dir}/src/python<br />
cp config.sample.json config.service.json</strong></li>
<li><p>Írjuk át a “config.service.json”-t </p>
<ol style="list-style-type: decimal">
<li>data_dir:”/var/local/rpd/data”</li>
<li>secure_port:10443</li>
<li>open_port:10080</li>
<li>crt_file:&lt;crt fájl helye&gt;</li>
<li>key_file:&lt;key fájl helye&gt;</li>
</ol></li>
</ol></li>
<li><p>Csináljunk egy service fájlt:</p>
<ol style="list-style-type: decimal">
<li>másoljuk le a sample-t<br />
<strong>cd {project_dir}/src/service<br />
cp rpd.sample.service rpd.service</strong></li>
<li><p>állítsuk be az “rpd.service”-t</p>
<ol style="list-style-type: decimal">
<li>ExecStart=/home/rpd-server/real_private_data/bin/server/rpd_server.sh --configFile &quot;[[dir_project]]/src/python/config.service.json&quot;</li>
<li>User=rpd-server</li>
</ol></li>
</ol></li>
<li>Hozzunk létre felhasználót (felhasználókat)<br />
<strong>su rpd-server<br />
./bin/server/rpd_create_user.sh –configFile ./src/python/config.service.json</strong></li>
<li>Másoljuk be a service fájlt a linux service könyvtárába<br />
<strong>sudo cp rpd.service /etc/systemd/system/<br />
systemctl daemon-reload<br />
systemctl start rpd<br />
systemctl enable rpd</strong></li>
<li><p>Csináljunk port forwardingot, hogy a 80-as és a 443 portokról lehessen elérni a szervert</p>
<p>sudo iptables -t nat -A OUTPUT -o lo -p tcp --dport 80 -j REDIRECT --to-port 10080</p>
<p>sudo iptables -t nat -A OUTPUT -o lo -p tcp --dport 443 -j REDIRECT --to-port 10443<br />
sudo iptables -i &lt;interface&gt; -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 10080</p>
<p>sudo iptables -i &lt;interface&gt; -t nat -A PREROUTING -p tcp --dport 443 -j REDIRECT --to-port 10443</p>
<p>su</p>
<p>iptables-save &gt; /etc/iptables/rules.v4</p>
<p>ip6tables-save &gt; /etc/iptables/rules.v6<br />
<br />
<br />
</p></li>
</ol>
<h2 id="konfigurálás"><span id="anchor-18"></span>Konfigurálás</h2>
<p>A konfigurálás két féle lehet.<br />
Vagy fájlból, vagy command line argumentumként megadva.<br />
A command line argumentumnak nagyobb priorítása van.<br />
Kötelező, hogy legyen config fájl.<br />
A konfigurációs paraméterek lehetnek publikusak, ez azt jelenti, hogy a kliens oldalon is láthatóak.<br />
A nem publikus konfig beállítások csak a szerver oldalon láthatóak.</p>
<h3 id="konfigurációs-változók"><span id="anchor-19"></span>Konfigurációs változók</h3>
<p>A konfigba vannak változók amiket [[változó név]]-ként érünk el.<br />
Például: <strong>./rpd_server.sh –logLevel /</strong><em><strong>var</strong></em><strong>/tmp/log[[now]].log<br />
./rpd_server.sh –logLevel /</strong><em><strong>var</strong></em><strong>/tmp/log20200330_163019.log </strong>lesz, vagy valami hasonló</p>
<table>
<tbody>
<tr class="odd">
<td>[[dir_project]]</td>
<td>A projekt gyökér könyvtára</td>
<td></td>
</tr>
<tr class="even">
<td>[[dir_src]]</td>
<td>A projekt src könyvtára</td>
<td></td>
</tr>
<tr class="odd">
<td>[[dir_web]]</td>
<td>A projektben lévő web könyvtára</td>
<td></td>
</tr>
<tr class="even">
<td>[[dir_python]]</td>
<td>A projektben lévő python fájlok könyvtára</td>
<td></td>
</tr>
<tr class="odd">
<td>[[now]]</td>
<td>Az aktuális idő ÉvHóNap_ÓraPercMásodperc formában</td>
<td>20200330_163019</td>
</tr>
<tr class="even">
<td>[[today]]</td>
<td>A mai nap ÉvHóNap formában</td>
<td>20200330</td>
</tr>
</tbody>
</table>
<p></p>
<h3 id="konfigurációs-opciók"><span id="anchor-20"></span>Konfigurációs opciók</h3>
<table>
<tbody>
<tr class="odd">
<td>configFile</td>
<td><p>Config json, ez az a konfig fájl, amiből a beállítások jönnek: config.json</p>
<p></p></td>
<td>./config.json</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>debug</td>
<td>Debug mód, ha be van kapcsolva, akkor több ellenőrzés van, több log van, de az a logLeveltől is függ.</td>
<td>False</td>
<td>Igen</td>
<td>Igen</td>
</tr>
<tr class="odd">
<td>logLevel</td>
<td>logLevel, értékei lehetnek<br />
CRITICAL - 50<br />
ERROR - 40<br />
WARNING - 30<br />
INFO - 20<br />
DEBUG -10<br />
NOTSET – 0<br />
Lásd: <a href="https://docs.python.org/3/library/logging.html" class="uri">https://docs.python.org/3/library/logging.html</a></td>
<td>INFO</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>logFile</td>
<td>Log fájl, helye, ha nem töltjük ki, akkor nem logolunk fájlba, csak a consolera.</td>
<td></td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="odd">
<td>logFormat</td>
<td>Log formátuma, ahogy a python várja lásd: <a href="https://docs.python.org/3/library/logging.html#logging.Formatter">https://docs.python.org/3/library/</a><a href="https://docs.python.org/3/library/logging.html#logging.Formatter">logging.html#logging.Formatter</a></td>
<td>[%(asctime)s][%(levelname)s] %(message)s</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>show_rpc_message</td>
<td>Mutassuk-e az rpc üzeneteket</td>
<td>False</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="odd">
<td>open_port</td>
<td>Indítunk egy http szervert is, ami átirányít a https szerverre, ennek a portja</td>
<td>8080</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>debug_open_port</td>
<td>Debug módban indítunk egy http szervert, ami nem titkos, ez segítheti a debuggolást, de nem biztonságos, így production rendszerbe nem fut</td>
<td>8081</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="odd">
<td>secure_port</td>
<td>A szerver portja, https kapcsolat</td>
<td>8443</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>host</td>
<td>a host neve, átirányításnál fontos</td>
<td>localhost</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="odd">
<td>crt_file</td>
<td>Certification fájl az SSL-hez</td>
<td>None</td>
<td>Nem</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>key_file</td>
<td>Key fájl az SSL-hez</td>
<td>None</td>
<td>Nem</td>
<td>Nem</td>
</tr>
<tr class="odd">
<td>web_root</td>
<td>a statikus fájlok könyvtára</td>
<td>None</td>
<td>Nem</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>data_dir</td>
<td>Az adatok mappája, ide lesznek elmentve a titkos fájljai a felhasználóknak</td>
<td>None</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="odd">
<td>test_dir</td>
<td>Egy mappa a tesztekhez</td>
<td>/var/tmp/real_private_data</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>salt</td>
<td>Egy hash &quot;só&quot; a kliens oldalra</td>
<td>My own Salt</td>
<td>Igen</td>
<td>Igen</td>
</tr>
<tr class="odd">
<td>server_salt</td>
<td>Egz hash &quot;só&quot; a szerver oldalra</td>
<td>Server salt</td>
<td>Igen</td>
<td>Nem</td>
</tr>
<tr class="even">
<td>enable_create_user</td>
<td>Engedélyezzük, hogy felhasználók is létre tudjanak hozni új felhasználókat, ha nem, akkor csak a szerveren lehet új felhasználókat létrehozni commandline paranccsal.</td>
<td>False</td>
<td>Igen</td>
<td>Igen</td>
</tr>
<tr class="odd">
<td>defaultRpcClient</td>
<td>Az alapértelmezett RPC metódus neve. jelenleg SimpleJsonRpcWebSocketClientService vagy </td>
<td>SimpleJsonRpcWebSocketClientService</td>
<td>Igen</td>
<td>Igen</td>
</tr>
<tr class="even">
<td>hideMessageTime</td>
<td>Az üzenetek elrejtése előtti idő ezredmásodpercben</td>
<td>5000</td>
<td>Igen</td>
<td>Igen</td>
</tr>
<tr class="odd">
<td>show_encrypted_data</td>
<td>Mutassa a weblapon a titkosított adatot</td>
<td>False</td>
<td>Igen</td>
<td>Igen</td>
</tr>
</tbody>
</table>
<h3 id="példa"><span id="anchor-21"></span>Példa</h3>
<p>my_config.json</p>
<p>{</p>
<p>&quot;debug&quot;:false,</p>
<p>&quot;logLevel&quot;:&quot;INFO&quot;,</p>
<p>&quot;logFile&quot;:&quot;/var/tmp/rpd_[[now]].log&quot;,</p>
<p>&quot;host&quot;:&quot;localhost&quot;,</p>
<p>&quot;open_port&quot;:8080,</p>
<p>&quot;secure_port&quot;:8443,</p>
<p>&quot;crt_file&quot;: &quot;[[dir_project]]/.key/rpd.crt&quot;,</p>
<p>&quot;key_file&quot;: &quot;[[dir_project]]/.key/rpd.key&quot;,</p>
<p>&quot;web_root&quot;: &quot;[[dir_project]]/src/web&quot;,</p>
<p>&quot;data_dir&quot;: &quot;[[dir_project]]/data&quot;</p>
<p>}</p>
<p></p>
<p>ha most meghívjuk a programot<br />
<strong>./rpd_server.sh –configFile –logLevel /</strong><em><strong>var</strong></em><strong>/tmp/log[[now]].log –configFile my_config.json –data_dir “[[dir_project]]/data2”</strong></p>
<p>akkor a command line data dir fog érvényesülni.</p>
<h2 id="használat"><span id="anchor-22"></span>Használat</h2>
<h3 id="szerver-oldal"><span id="anchor-23"></span>Szerver oldal</h3>
<p>Alapjában véve a <strong>./bin </strong>mappában vannak a futtatható fájlok, ott van egy <strong>server </strong>és egy <strong>tools</strong></p>
<p>A <strong>server</strong> mappában vannak a szerverhez kellő dolgok, a <strong>tools </strong>mappában a fejlesztéshez szükséges toolok, ezért azokat majd a fejlesztői dokumentációban fogom részletezni.</p>
<h4 id="binserverrpd_server.sh"><span id="anchor-24"></span>./bin/server/rpd_server.sh</h4>
<p>Lásd <strong>./src/python/run_server.py</strong></p>
<h4 id="binserverrpd_create_user.sh"><span id="anchor-25"></span>./bin/server/rpd_create_user.sh</h4>
<p>Lásd <strong>./src/python/create_user.py</strong></p>
<h4 id="srcpythonrun_server.py"><span id="anchor-26"></span>./src/python/run_server.py</h4>
<p>Maga a szerver, a beállításokat lásd a <strong>Konfigurálás</strong> fejezetet, alapértelmezettként a <strong>./src/python/config.json </strong>fájlt fogja betölteni --<strong>configFile </strong></p>
<h4 id="srcpythoncreate_user.py"><span id="anchor-27"></span>./src/python/create_user.py</h4>
<p>Felhasználó létrehozása, érdemes beállítani a –<strong>configFile</strong>-t, alapértelmezettként a <strong>./src/python/config.json </strong>fájlt használja.</p>
<p><img src="Pictures/1000020100000302000000867699C55659AA7F03.png" width="642" height="111" /><br />
<strong>Enter your username:</strong> Írd be a felhasználónevet<br />
<strong>Enter your password:</strong> Írd be a jelszót<br />
<strong>Enter your password again:</strong> Írd be a jelszót megint</p>
<p></p>
<h3 id="kliens-oldal"><span id="anchor-28"></span>Kliens oldal</h3>
<h4 id="az-oldal-elérése"><span id="anchor-29"></span>Az oldal elérése</h4>
<p>Az oldalt az épp aktuális címén lehet elérni a böngészőben, de ha nem akarunk SSL hitelesítést venni, akkor sajnos a böngésző “nem biztonságos”-nak fogja látni az oldalunkat.</p>
<p><img src="Pictures/100002010000027A000003141821B461CE63CD4B.png" width="295" height="435" /><img src="Pictures/1000020100000240000003656F3E774A6844520D.png" width="305" height="431" /></p>
<p></p>
<h4 id="bejelentkezés"><span id="anchor-30"></span>Bejelentkezés</h4>
<p>RPC Client:</p>
<p><em>SimpleJsonRpcWebSocketClientService</em>: a kommunikációhoz használjuk a SimpleJsonRpcWebSocketClient-et, ez egy websocket alapú kommunikáció.<br />
Előnye, hogy folyamatos kapcsolat van a szerver, és a kliens között, Hátránya, hogy így folyamatosan van kommunikációs forgalom, de csak elhanyagolható.</p>
<p><em>SimpleJsonRpcPOSTClientService</em>: HTTP post alapú kommunikációt biztosít.<br />
Előnye, hogy csak akkor van kommunikáció, amikor szervertől kérünk valamit.<br />
Hátránya, hogy mindig új kapcsolatot kell létesíteni.</p>
<p><img src="Pictures/10000201000001F40000014517A57B782B43355D.png" width="499" height="324" /><strong>Username:</strong>felhasználónév<br />
<strong>Password:</strong> jelszó<br />
<strong>Login</strong>: bejelentkezés gomb a bejelentkezéshez</p>
<h4 id="a-főoldal-struktúrája">A főoldal struktúrája</h4>
<p><img src="Pictures/10000201000002CE000002D4BBD02C325AD91ACD.png" width="642" height="647" /></p>
<h4 id="a-főoldal-gombjai">A főoldal gombjai</h4>
<p><img src="Pictures/10000201000002CE000002D481DF485A34A1C615.png" width="642" height="647" /></p>
<p>Felhasználó létrehozása gomb</p>
<p>Ez a gomb csak akkor jelenik meg, ha a enable_create_user opció True (lásd Konfigurálás fejezet)</p>
<p>A fájl neve</p>
<p>Ha rákattintasz, megnyitja a fájlt.</p>
<h5 id="fájl-létrehozása-menü"><img src="Pictures/10000201000000DA00000090C1CC68BAF501167F.png" width="218" height="144" />Fájl létrehozása menü</h5>
<p>Create txt file: Létrehoz egy txt fájlt</p>
<p>Create phonebook file: Létrehoz egy telefonkönyv fájlt</p>
<h5 id="fájl-átnevezés">Fájl átnevezés</h5>
<p><img src="Pictures/100002010000023F00000090DC9F588F7050B468.png" width="575" height="144" />Fájl neve mező:Ide kell beírni az új nevét a fájlnak</p>
<p>Save gomb:Elmenti a névváltoztatást</p>
<p>Cancel gomb:Megszakítja a névváltoztatást</p>
<h1 id="fejlesztői-dokumentáció"><span id="anchor-31"></span>Fejlesztői dokumentáció</h1>
<h2 id="tesztelési-terv"><span id="anchor-32"></span>Tesztelési terv</h2>
<p>A txt fájlok teszteléséhez Arany János összes költeményeit használom:</p>
<p><a href="https://mek.oszk.hu/00500/00597/html/index.htm" class="uri">https://mek.oszk.hu/00500/00597/html/index.htm</a></p>
<p>A telefonkönyvek teszteléséhez az ELTE honlapján elérhető telefonszámokat használom:</p>
<ol style="list-style-type: decimal">
<li>ELTE IK Média- és Oktatásinformatikai Tanszék &gt; A Tanszékről &gt; Oktatók és munkatársak<br />
<a href="https://mot.inf.elte.hu/munkatarsak" class="uri">https://mot.inf.elte.hu/munkatarsak</a></li>
</ol>
<h3 id="előkészületek-1"><span id="anchor-33"></span>Előkészületek</h3>
<p>Létrehozok egy üres adatbázist a projekt mellé, és megcsinálom a szükséges config fájlt:</p>
<p>{</p>
<p>&quot;host&quot;:&quot;localhost&quot;,</p>
<p>&quot;logFile&quot;:&quot;/var/tmp/rpd_test_[[now]].log&quot;,</p>
<p>&quot;open_port&quot;:11080,</p>
<p>&quot;secure_port&quot;:11443,</p>
<p>&quot;enable_create_user&quot;: true,<br />
&quot;logLevel&quot;:&quot;DEBUG&quot;,</p>
<p>&quot;show_encrypted_data&quot;: true,</p>
<p>&quot;crt_file&quot;: &quot;[[dir_project]]/../.key/rpd.crt&quot;,</p>
<p>&quot;key_file&quot;: &quot;[[dir_project]]/../.key/rpd.key&quot;,</p>
<p>&quot;web_root&quot;: &quot;[[dir_project]]/src/web&quot;,</p>
<p>&quot;data_dir&quot;: &quot;[[dir_project]]/../test_data&quot;</p>
<p>}</p>
<h3 id="eset-a-szerver-elindítása-black-box"><span id="anchor-34"></span>1. eset: A szerver elindítása (black box)</h3>
<p>./run_server --configFile config.test.json</p>
<h4 id="elvárt-eredmény"><span id="anchor-35"></span>Elvárt eredmény</h4>
<p>1. <strong>Loggolja a konfigurált beállításokat:</strong></p>
<p>[2020-04-08 12:25:01,276][INFO] Loglevel: INFO</p>
<p>[2020-04-08 12:25:01,440][INFO] Runner command: ./run_server.py --configFile config.test.json</p>
<p>[2020-04-08 12:25:01,440][INFO] Config:</p>
<p>[2020-04-08 12:25:01,440][INFO] configFile: config.test.json</p>
<p>[2020-04-08 12:25:01,440][INFO] debug: False</p>
<p>[2020-04-08 12:25:01,440][INFO] logLevel: INFO</p>
<p>[2020-04-08 12:25:01,440][INFO] logFile: /var/tmp/rpd_test_20200408_122501.log</p>
<p>[2020-04-08 12:25:01,440][INFO] logFormat: [%(asctime)s][%(levelname)s] %(message)s</p>
<p>[2020-04-08 12:25:01,440][INFO] show_rpc_message: False</p>
<p>[2020-04-08 12:25:01,440][INFO] open_port: 11080</p>
<p>[2020-04-08 12:25:01,440][INFO] debug_open_port: 8081</p>
<p>[2020-04-08 12:25:01,440][INFO] secure_port: 11443</p>
<p>[2020-04-08 12:25:01,441][INFO] host: localhost</p>
<p>[2020-04-08 12:25:01,441][INFO] crt_file: /home/somla/working/rpd/master/../.key/rpd.crt</p>
<p>[2020-04-08 12:25:01,441][INFO] key_file: /home/somla/working/rpd/master/../.key/rpd.key</p>
<p>[2020-04-08 12:25:01,441][INFO] web_root: /home/somla/working/rpd/master/src/web</p>
<p>[2020-04-08 12:25:01,441][INFO] data_dir: /home/somla/working/rpd/master/../test_data</p>
<p>[2020-04-08 12:25:01,441][INFO] test_dir: /var/tmp/real_private_data</p>
<p>[2020-04-08 12:25:01,441][INFO] salt: My own Salt</p>
<p>[2020-04-08 12:25:01,441][INFO] server_salt: Server salt</p>
<p>[2020-04-08 12:25:01,441][INFO] enable_create_user: True</p>
<p>[2020-04-08 12:25:01,441][INFO] show_encrypted_data: True</p>
<p>[2020-04-08 12:25:01,441][INFO] defaultRpcClient: SimpleJsonRpcWebSocketClientService</p>
<p>[2020-04-08 12:25:01,441][INFO] hideMessageTime: 4000</p>
<p></p>
<p>2. loggolja a szerver elérhetőségeit:</p>
<p>[2020-04-08 12:25:01,443][INFO] HTTPS Server starting... https://localhost:11443/</p>
<p>[2020-04-08 12:25:01,444][INFO] HTTP redirect Server starting... <a href="http://localhost:11080/" class="uri">http://localhost:11080/</a></p>
<p></p>
<p><strong>3. írja ki őket a /var/tmp/rpd_test_*.log</strong> (a * helyére az aktuális dátumot várom)</p>
<p>A /var/tmp/rpd_test_20200408_122501.log fájl tényleg létrejött, és tényleg ugyanaz van benne, mint a képernyőn.</p>
<p></p>
<p>4. A <a href="http://localhost:11080/" class="uri">http://localhost:11080/</a> -re kattintva jussunk el az átirányító oldalra, és az irányítson át minket a titkosított oldalra</p>
<p></p>
<p><img src="Pictures/100002010000035B000000B22FB9CDEA4FD37054.png" width="642" height="133" />3 másodperc múlva</p>
<p><img src="Pictures/10000201000001F40000014517A57B782B43355D.png" width="499" height="324" /></p>
<h3 id="eset-felhasználók-létrehozása-konzolból-black-box"><span id="anchor-36"></span>2. eset: Felhasználók létrehozása konzolból (black box)</h3>
<p>2 felhasználót fogok létrehozni</p>
<p><img src="Pictures/100002010000031D000000F2976BA035B3996C7B.png" width="642" height="195" /><strong>Felhasználónév</strong>: test_user1 <strong>password:</strong> password1<br />
<strong>Felhasználónév</strong>: test_user2 <strong>password: </strong>password2</p>
<p><img src="Pictures/100002010000031D000000F2E88902532E77D116.png" width="642" height="195" /></p>
<h4 id="elvárt-eredmény-1"><span id="anchor-37"></span>Elvárt eredmény</h4>
<p>1. Hozzon létre két felhasználói mappát:</p>
<p><img src="Pictures/100002010000024E000000623AFAC37FC5C00533.png" width="589" height="98" />2. Be tudjak lépni a felhasználókkal, ezt lásd lejjebb a bejelentkezés tesztelésénél.</p>
<h3 id="eset-üresen-hagyott-mezők-felhasználó-létrehozása-közben"><span id="anchor-38"></span>3. eset: Üresen hagyott mezők felhasználó létrehozása közben</h3>
<p>Vagy a felhasználónevet, vagy a jelszó mezőt, vagy mindkettőt hagyjuk üresen</p>
<h4 id="elvárt-eredmény-2"><span id="anchor-39"></span>Elvárt eredmény</h4>
<p><img src="Pictures/100002010000031D0000013A193006CF92705A40.png" width="623" height="245" /><strong>Username and/or password is empty</strong> üzenet, a data dir változatlan hagyása</p>
<h3 id="eset-jelszó-és-jelszó-mégegyszer-nem-egyezik-cli"><span id="anchor-40"></span>4. eset: jelszó és jelszó mégegyszer nem egyezik (CLI)</h3>
<h3 id="section"><img src="Pictures/100002010000031D00000086F18BAFFF29656A89.png" width="642" height="108" /></h3>
<h4 id="elvárt-eredmény-3"><span id="anchor-41"></span>Elvárt eredmény</h4>
<p>Hibaüzenet, test_data dir ne változzon</p>
<h3 id="eset-létező-felhasználó-hozzáadása-azonos-jelszóval"><span id="anchor-42"></span>5. eset: Létező felhasználó hozzáadása azonos jelszóval</h3>
<p>Meg kell jegyezzem, hogy itt a felhasználónév és a jelszó páros azonosít egy felhasználót, így például <strong>User1/password1</strong> és <strong>User1/password2</strong> nem ugyanaz a felhasználó.</p>
<p>Gondolkodtam ennek javításán, de nem igazán lehetséges úgy, hogy ne adjon többlet információt a szerver üzemeltetőjének a felhasználóról.</p>
<p>test_user1/password1</p>
<p><img src="Pictures/100002010000031D0000008614CCB9C6A936E847.png" width="642" height="108" /></p>
<h4 id="elvárt-eredmény-4"><span id="anchor-43"></span>Elvárt eredmény</h4>
<p>Hibaüzenet, test_data dir ne változzon</p>
<h3 id="eset-létező-felhasználó-hozzáadása-más-jelszóval-cli"><span id="anchor-44"></span>6. eset: Létező felhasználó hozzáadása más jelszóval (cli)</h3>
<p><strong>test_user1/password2</strong> létrehozása</p>
<h4 id="elvárt-eredmény-5"><img src="Pictures/100002010000031D00000086C6457FFF882A34CD.png" width="613" height="103" /><span id="anchor-45"></span>Elvárt eredmény</h4>
<p>1. Hozzon létre egy új felhasználói mappát</p>
<p><img src="Pictures/100002010000024E00000074FBA42ABA16A2EA41.png" width="589" height="115" /></p>
<p>2. Be tudjak lépni az új felhasználóval, ezt lásd lejjebb a bejelentkezés tesztelésénél.</p>
<h3 id="eset-belépés-hibás-jelszóval-gui"><span id="anchor-46"></span>7. eset: Belépés hibás jelszóval (GUI)</h3>
<p>Bejelentkezés<strong> </strong>a következő felhasználókkal</p>
<table>
<tbody>
<tr class="odd">
<td>Felhasználónév</td>
<td>Jelszó</td>
</tr>
<tr class="even">
<td>I am not exist</td>
<td>I am not exist</td>
</tr>
<tr class="odd">
<td>test_user1</td>
<td>almafa</td>
</tr>
<tr class="even">
<td>test_user2</td>
<td>dinnye</td>
</tr>
</tbody>
</table>
<p></p>
<p>(<strong>SimpleJsonRpcWebSocketClientService</strong> és <strong>SimpleJsonRpcPOSTClientService </strong>segítségével is)</p>
<h4 id="elvárt-eredmény-6"><span id="anchor-47"></span>Elvárt eredmény</h4>
<p><img src="Pictures/10000201000001FC0000017DFCC82713BC118645.png" width="508" height="381" />Hibaüzenet</p>
<h3 id="eset-bejelentkezés-valós-felhasználókkal-gui"><span id="anchor-48"></span>8. eset: Bejelentkezés valós felhasználókkal (GUI)</h3>
<p>Bejelentkezés<strong> </strong>a következő felhasználókkal (<strong>SimpleJsonRpcWebSocketClientService</strong> és <strong>SimpleJsonRpcPOSTClientService </strong>segítségével is)</p>
<table>
<tbody>
<tr class="odd">
<td>Felhasználónév</td>
<td>Jelszó</td>
</tr>
<tr class="even">
<td>test_user1</td>
<td>password1</td>
</tr>
<tr class="odd">
<td>test_user1</td>
<td>password2</td>
</tr>
<tr class="even">
<td>test_user2</td>
<td>password2</td>
</tr>
</tbody>
</table>
<p></p>
<h4 id="elvárt-eredmény-7"><span id="anchor-49"></span>Elvárt eredmény</h4>
<p>Bejelentkezés az oldalra, és a main oldalra irányítás.</p>
<h3 id="section-1"><img src="Pictures/10000201000001D900000140756AC15CC24E107F.png" width="473" height="320" /></h3>
<h3 id="eset-felhasználó-létrehozása-gui"><span id="anchor-50"></span>9. eset: Felhasználó létrehozása (GUI)</h3>
<p><strong>test_user3/password3</strong> létrehozása</p>
<h4 id="elvárt-eredmény-8"><span id="anchor-51"></span>Elvárt eredmény</h4>
<p>1. sikeres létrehozás</p>
<p><img src="Pictures/100002010000023D000001AA20A24A135A40C772.png" width="573" height="425" />2. sikeres bejelntekzés az új felhasználóval (lásd <strong>8. eset: Bejelentkezés valós felhasználókkal (GUI) </strong>).</p>
<h3 id="eset-txt-fájl-létrehozása"><span id="anchor-52"></span>10. eset: Txt Fájl létrehozása</h3>
<p>Hozzunk létre pár txt fájlt.</p>
<h4 id="elvárt-eredmény-9"><span id="anchor-53"></span>Elvárt eredmény</h4>
<p>A fájlok létrejönnek, és meg is tudjuk őket nyitni, lásd lejjebb</p>
<p><img src="Pictures/100002010000039700000391C7F524C2E18491CD.png" width="604" height="600" /></p>
<h3 id="eset-telefonkönyv-fájl-létrehozása"><span id="anchor-54"></span>11. eset: Telefonkönyv fájl létrehozása</h3>
<p>Ehhez csináltam egy teszt robotot, ami létrehoz egy Telefonkönyv fájlt, és feltölti adatokkal.</p>
<p><a href="https://localhost:11443/testPhoneBook.html" class="uri">https://localhost:11443/testPhoneBook.html</a></p>
<p><strong>waitTime</strong>: Megmondja, hogy mennyit várjon a teszt két művelet között<br />
<strong>username</strong>: Melyik felhasználóval lépjen be<br />
<strong>password</strong>: Mi a felhasználó jelszava<br />
<strong>fileName</strong>: Mi legyen a létrehozandó fájl neve<br />
<strong>filePassword</strong>: Mi legyen a jelszava</p>
<p><img src="Pictures/10000201000001FC0000022BBC859C5CC233AF1F.png" width="508" height="554" /></p>
<h4 id="elvárt-eredmény-10"><span id="anchor-55"></span>Elvárt eredmény</h4>
<p>A fájl létrehozása, és a telefonkönyv adatok tárolása.</p>
<h3 id="eset-nézzük-meg-hogy-a-szerveren-tárolt-adatok-tényleg-titkosak-e"><span id="anchor-56"></span>12. eset: Nézzük meg, hogy a szerveren tárolt adatok tényleg titkosak-e</h3>
<ol style="list-style-type: decimal">
<li>Kilistázzuk a mappákat tee paranccsal</li>
<li>megnézzük a fájlokat cat paranccsal</li>
<li>megnézzük a fájlokat hexdump paranccsal</li>
</ol>
<p><img src="Pictures/100002010000024E000002A2BFA6C3F2C761EB55.png" width="589" height="674" />Itt látható, hogy mind a mappák (felhasználók nevei), és a benne lévő fájlok nevei is titkosítottak.</p>
<p><img src="Pictures/100002010000024E000002B41EE2773EF9BEFDC2.png" width="589" height="691" />Itt látható, hogy a fájl cat-tal megjelenítve is értelmetlen</p>
<h3 id="a-teszt-közben-létrejött-felhasználók-és-fájlok"><span id="anchor-57"></span>A teszt közben létrejött felhasználók és fájlok</h3>
<h4 id="felhasználók"><span id="anchor-58"></span>Felhasználók</h4>
<table>
<tbody>
<tr class="odd">
<td>test_user1</td>
<td>password1</td>
<td></td>
</tr>
<tr class="even">
<td>test_user1</td>
<td>password2</td>
<td></td>
</tr>
<tr class="odd">
<td>test_user2</td>
<td>password2</td>
<td></td>
</tr>
<tr class="even">
<td>test_user3</td>
<td>password3</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="fájlok"><span id="anchor-59"></span>Fájlok</h4>
<table>
<tbody>
<tr class="odd">
<td>test_user1/password1</td>
<td>A MÉH ROMÁNCA.txt</td>
<td>Petofi</td>
<td></td>
</tr>
<tr class="even">
<td>test_user1/password1</td>
<td>A SZEGÉNY JOBBÁGY.txt</td>
<td>Petofi</td>
<td></td>
</tr>
<tr class="odd">
<td>test_user1/password1</td>
<td>A VARRÓ LEÁNYOK.txt</td>
<td>Petofi</td>
<td></td>
</tr>
<tr class="even">
<td>test_user1/password1</td>
<td>ARANYAIMHOZ.txt</td>
<td>Petofi</td>
<td></td>
</tr>
<tr class="odd">
<td>test_user1/password1</td>
<td>EGYKORI TANÍTVÁNYOM EMLÉKKÖNYVÉBE.txt</td>
<td>Petofi</td>
<td></td>
</tr>
<tr class="even">
<td>test_user1/password1</td>
<td>VÁLASZ PETŐFINEK.txt</td>
<td>Petofi</td>
<td></td>
</tr>
<tr class="odd">
<td>test_user1/password1</td>
<td>ELTE IK Média- és Oktatásinformatikai Tanszék.phb</td>
<td>Media</td>
<td></td>
</tr>
</tbody>
</table>
<p></p>
</body>
</html>
